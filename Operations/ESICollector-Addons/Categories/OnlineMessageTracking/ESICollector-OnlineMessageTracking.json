{
    "SolutionMetadata":
	{
		"JSonVersion":"1.0",
		"JsonUpdateDate":"27/09/2022",
		"Description":"Online Message Tracking Auditing to Microsoft Sentinel",
		"VersionInformation":{
			"1.0":{
				"Tracking":["First version of the file"],
				"MigrationMessageFromLastVersion":"N/A"
			}
		}
	},
	"AuditFunctionProtectedArea":
	{
		"ContentCheckSum":"A7068A39A4647CB33704038F09B4D8C71DB39C4C32632710C539C245577F65AF"
	},
    "AuditFunctions":[
		{
			"Section":"OnlineMessageTracking",
			"Cmdlet":"Get-MessageTrace -StartDate \"#LastDateOfSection#\" -EndDate \"#ScriptLaunchedDate#\"",
			"PropertySelection":["*"],
			"CustomExpressionForSelection":[],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All",
			"PaginationInformation":{
				"PaginationActivated":"true",
				"PageSize":5000,
				"MaxPage":2000,
				"PartialDataUpload":"true",
				"StorePagesInMemory":"true"
			},
			"DateStorageInformation":{
				"DateStorageActivated":"true",
				"DateAttribute":"date",
				"DateStorageMode":"LastDate",
				"DateReset":"true"
			}
		},
		{
			"Section":"OnlineDetailedMessageTracking",
			"Cmdlet":"$MailList = Get-MessageTrace -StartDate \"#LastDateTracking#\" -EndDate \"#ScriptLaunchedDate#\" #Pagination# ; foreach ($mail in $MailList){Get-MessageTraceDetail -MessageTraceId $mail.MessageTraceId -MessageId $mail.MessageId -RecipientAddress $mail.RecipientAddress }",
			"PropertySelection":["*"],
			"CustomExpressionForSelection":[],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All",
			"PaginationInformation":{
				"PaginationActivated":"true",
				"PageSize":5000,
				"MaxPage":2000,
				"PartialDataUpload":"true",
				"StorePagesInMemory":"true"
			},
			"DateStorageInformation":{
				"DateStorageActivated":"true",
				"DateAttribute":"date",
				"DateStorageMode":"LastDate",
				"DateReset":"true"
			}
		}
    ]
}
