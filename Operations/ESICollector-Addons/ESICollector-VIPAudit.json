{
    "SolutionMetadata":
	{
		"JSonVersion":"1.0",
		"JsonUpdateDate":"27/09/2022",
		"Description":"All Audit Functions around VIP Audit",
		"VersionInformation":{
			"1.0":{
				"Tracking":["First version of the file"],
				"MigrationMessageFromLastVersion":"N/A"
			}
		}
	},
	"AuditFunctionProtectedArea":
	{
		"ContentCheckSum":"2CF717CBCF5372A2B095C9E20D5F46F5AD0E66C8673FB61FFD463AD0BBD35A61"
	},
    "AuditFunctions":[
        {
			"Section":"MAL",
			"Cmdlet":"'$Userlist = get-mailbox | ? { $_.AuditEnabled -eq $true} ; foreach ($user in $Userlist){Search-MailboxAuditLog -Identity $user -LogonTypes delegate,owner,admin -ShowDetails -StartDate \"#LastDateTracking#\" }'",
			"PropertySelection":["LastAccessed","MailboxOwnerUPN","MailboxResolvedOwnerName","LogonUserDisplayName ","LogonType","Operation","FolderPathName","ClientInfoString","ClientIPAddress","InternalLogonType","ItemID","ItemSubject","ItemAttachments","SourceItemIdsList","SourceItemSubjectsList","SourceItemAttachmentsList","SourceItemFolderPathNamesList","SourceFolderPathNamesList","OperationResult"],
			"CustomExpressionForSelection":[
				{"Name":"LastAccessedString","Expression":"$_.LastAccessed.ToString()"},
				{"Name":"SourceItems","Expression":"[string]::join(\";\", ($_.SourceItems))"},
				{"Name":"SourceFolders","Expression":"[string]::join(\";\", ($_.SourceFolders))"}
				
			],
			"ProcessPerServer":"false",
			"OutputStream":"VIPMailboxAuditLog.csv",
			"ProcessingCategory":"All"
		}
    ]
}
